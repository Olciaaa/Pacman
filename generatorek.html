<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="stylgen.css">
    <title>generatorek</title>
    <script>
        window.addEventListener('DOMContentLoaded', (event) => {
            let parameters = [];
            let saved = [];
            const sizeOfBox = 47;
            const size = 15;
            const margin = 40;
            for(i = 0; i <= 32; i++)
            {
                parameters[i] = [];
                for(j = 0; j <= 20; j++)
                {
                    parameters[i][j] = ({cutX: i+1 + sizeOfBox*i,
                                        cutY: j+1 + sizeOfBox*j,
                                        cutWidth: sizeOfBox,
                                        cutHeight: sizeOfBox,
                                        x: size*i,
                                        y: size*j,
                                        width: size,
                                        height: size})
                }
            }
            let main = document.createElement("div");
            main.id = "main";
            document.body.appendChild(main);
            let items = document.createElement("div");
            items.id = "items";
            main.appendChild(items);
            let board = document.createElement("div");
            board.id = "board";
            main.appendChild(board);

            const sizeOfItem = 20;
            const img = new Image();
            img.src = 'sprites.png';

            img.addEventListener('load', function() 
            {
                for(let i = 0; i <= 31; i++)
                {
                    for(let j = 0; j <= 19; j++)
                    {
                        let canvas = document.createElement("canvas");
                        canvas.className = "canvas";
                        canvas.id = "s" + i.toString() + j.toString();
                        canvas.width=sizeOfItem;
                        canvas.height=sizeOfItem;
                        canvas.style.top = sizeOfItem * j + "px";
                        canvas.style.left = sizeOfItem * i + "px";
                        canvas.style.opacity = "0.3"  

                        let ctx=canvas.getContext("2d");

                        ctx.drawImage(img,1+47*i+i,1+47*j+j,47,47,0,0,sizeOfItem,sizeOfItem)

                        items.appendChild(canvas);
                        canvas.onmouseover = function()
                        {
                            //console.log(this);
                            canvas.style.opacity = "1";
                        }
                        canvas.onmouseleave = function()
                        {
                            canvas.style.opacity = "0.3";
                        }
                        canvas.onclick = function()
                        {
                            clickedSprite(canvas,i,j);
                        }
                    }
                }
            });

            let boardElement;

            const sizeOfElement = 25
            img.addEventListener('load', function() 
            {
                for(let i = 0; i <= 30; i++)
                {
                    for(let j = 0; j <= 40; j++)
                    {
                        let canvas = document.createElement("canvas");
                        canvas.className = "canvass";
                        canvas.id = "b" + i.toString() + "j"+ j.toString();
                        canvas.width=sizeOfElement;
                        canvas.height=sizeOfElement;
                        canvas.style.top = sizeOfElement * j + "px";
                        canvas.style.left = sizeOfElement * i + "px";

                        let ctx=canvas.getContext("2d");

                        //ctx.drawImage(img,1+47*i+i,1+47*j+j,47,47,0,0,sizeOfItem,sizeOfItem)

                        board.appendChild(canvas);
                        
                        canvas.onclick = function()
                        {
                            console.log(canvas)
                            clickedElement(canvas);
                        }
                    }
                }
            });

            let clickedElement = function(hmm)
            {
                for(let i = 0; i <= 30; i++)
                {
                    for(let j = 0; j <= 40; j++)
                    {
                        document.getElementById("b"+i.toString()+"j"+j.toString()).style.background = "";
                        document.getElementById("b"+i.toString()+"j"+j.toString()).style.border = "1px dotted darkmagenta";
                    }
                }
                hmm.style.border = "1px solid #FB06A5";
                hmm.style.background = "#FB06A5";
                boardElement = hmm.id;
            }
            let clickedSprite = function(hmm,i,j)
            {
                console.log(hmm.id);
                console.log(document.getElementById(boardElement));
                (document.getElementById(boardElement).getContext("2d")).drawImage(img,1+47*i+i,1+47*j+j,47,47,0,0,sizeOfElement,sizeOfElement);
                saved.push(`${img},${1+47*i+i},${1+47*j+j},${47},${47},${0},${0},${sizeOfElement},${sizeOfElement}`);
                console.log(saved);
            }
        });
    </script>
</head>
<body>
</body>
</html>